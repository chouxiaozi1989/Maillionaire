# Maillionaire - äºŒæ¬¡å¼€å‘æ–‡æ¡£

## ğŸ“š ç›®å½•

1. [å¼€å‘ç¯å¢ƒæ­å»º](#å¼€å‘ç¯å¢ƒæ­å»º)
2. [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
3. [æ ¸å¿ƒæ¨¡å—è¯´æ˜](#æ ¸å¿ƒæ¨¡å—è¯´æ˜)
4. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
5. [æ‰©å±•åŠŸèƒ½](#æ‰©å±•åŠŸèƒ½)
6. [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å¼€å‘ç¯å¢ƒæ­å»º

### 1. å‰ç½®è¦æ±‚

- **Node.js**: >= 16.x
- **npm**: >= 8.x æˆ– **yarn**: >= 1.22.x
- **Git**: æœ€æ–°ç‰ˆæœ¬
- **ç¼–è¾‘å™¨**: VS Codeï¼ˆæ¨èï¼‰

### 2. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/maillionaire/maillionaire.git
cd maillionaire
```

### 3. å®‰è£…ä¾èµ–

```bash
npm install
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# Webå¼€å‘æ¨¡å¼
npm run dev

# Electronå¼€å‘æ¨¡å¼
npm run electron:dev
```

### 5. VS Codeæ¨èæ’ä»¶

- **Volar** - Vue 3å®˜æ–¹æ’ä»¶
- **ESLint** - ä»£ç è§„èŒƒæ£€æŸ¥
- **Prettier** - ä»£ç æ ¼å¼åŒ–
- **Path Intellisense** - è·¯å¾„è‡ªåŠ¨å®Œæˆ
- **Auto Rename Tag** - æ ‡ç­¾è‡ªåŠ¨é‡å‘½å

---

## é¡¹ç›®æ¶æ„

### æŠ€æœ¯æ ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Electron (Desktop Shell)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Vue 3 + Vite (Frontend Framework)      â”‚
â”‚  - Composition API                       â”‚
â”‚  - <script setup> syntax                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Ant Design Vue (UI Components)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Pinia (State Management)                â”‚
â”‚  - app store                             â”‚
â”‚  - account store                         â”‚
â”‚  - mail store                            â”‚
â”‚  - contact store                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Services Layer                          â”‚
â”‚  - Storage Service (Local File Storage) â”‚
â”‚  - IMAP Service (Receive Mails)         â”‚
â”‚  - SMTP Service (Send Mails)            â”‚
â”‚  - OAuth Service (Authentication)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„è¯¦è§£

```
src/
â”œâ”€â”€ assets/              # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/          # å›¾ç‰‡èµ„æº
â”‚   â”œâ”€â”€ fonts/           # å­—ä½“æ–‡ä»¶
â”‚   â””â”€â”€ icons/           # å›¾æ ‡æ–‡ä»¶
â”‚
â”œâ”€â”€ components/          # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ common/          # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Button.vue
â”‚   â”‚   â”œâ”€â”€ Modal.vue
â”‚   â”‚   â””â”€â”€ Loading.vue
â”‚   â”œâ”€â”€ mail/            # é‚®ä»¶ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ MailList.vue
â”‚   â”‚   â”œâ”€â”€ MailItem.vue
â”‚   â”‚   â””â”€â”€ MailDetail.vue
â”‚   â””â”€â”€ editor/          # å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
â”‚       â””â”€â”€ RichEditor.vue
â”‚
â”œâ”€â”€ views/               # é¡µé¢è§†å›¾
â”‚   â”œâ”€â”€ Login.vue        # ç™»å½•é¡µ
â”‚   â”œâ”€â”€ Main.vue         # ä¸»ç•Œé¢å¸ƒå±€
â”‚   â”œâ”€â”€ Contacts.vue     # é€šè®¯å½•
â”‚   â”œâ”€â”€ Settings.vue     # è®¾ç½®é¡µé¢
â”‚   â””â”€â”€ mail/            # é‚®ä»¶é¡µé¢
â”‚
â”œâ”€â”€ stores/              # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ app.js           # åº”ç”¨å…¨å±€çŠ¶æ€
â”‚   â”œâ”€â”€ account.js       # è´¦æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ mail.js          # é‚®ä»¶ç®¡ç†
â”‚   â””â”€â”€ contact.js       # é€šè®¯å½•ç®¡ç†
â”‚
â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”œâ”€â”€ storage.js       # æœ¬åœ°å­˜å‚¨
â”‚   â”œâ”€â”€ imap.js          # IMAPæ”¶ä»¶
â”‚   â”œâ”€â”€ smtp.js          # SMTPå‘ä»¶
â”‚   â””â”€â”€ oauth.js         # OAuth2è®¤è¯
â”‚
â”œâ”€â”€ router/              # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ index.js
â”‚
â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ date.js          # æ—¥æœŸå¤„ç†
â”‚   â”œâ”€â”€ validation.js    # è¡¨å•éªŒè¯
â”‚   â””â”€â”€ crypto.js        # åŠ å¯†è§£å¯†
â”‚
â”œâ”€â”€ styles/              # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ index.scss       # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ variables.scss   # SCSSå˜é‡
â”‚   â””â”€â”€ mixins.scss      # SCSSæ··å…¥
â”‚
â”œâ”€â”€ App.vue              # æ ¹ç»„ä»¶
â””â”€â”€ main.js              # åº”ç”¨å…¥å£
```

---

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. Electronä¸»è¿›ç¨‹ (electron/main.js)

**èŒè´£**:
- åˆ›å»ºå’Œç®¡ç†çª—å£
- IPCé€šä¿¡å¤„ç†
- ç³»ç»Ÿçº§APIè°ƒç”¨

**å…³é”®ä»£ç **:
```javascript
// åˆ›å»ºä¸»çª—å£
function createWindow() {
  const mainWindow = new BrowserWindow({
    width: 1440,
    height: 900,
    webPreferences: {
      nodeIntegration: true,
      contextIsolation: false,
    },
  })
}

// IPCé€šä¿¡ç¤ºä¾‹
ipcMain.handle('get-app-path', () => {
  return app.getPath('userData')
})
```

**æ‰©å±•ç‚¹**:
- æ·»åŠ æ–°çš„IPCé€šä¿¡é€šé“
- å®ç°ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½
- æ·»åŠ å…¨å±€å¿«æ·é”®

### 2. PiniaçŠ¶æ€ç®¡ç†

#### App Store (stores/app.js)

**çŠ¶æ€**:
```javascript
{
  appDataPath: string,      // åº”ç”¨æ•°æ®è·¯å¾„
  loading: boolean,          // å…¨å±€åŠ è½½çŠ¶æ€
  sidebarCollapsed: boolean, // ä¾§è¾¹æ æŠ˜å çŠ¶æ€
  theme: string,             // ä¸»é¢˜æ¨¡å¼
}
```

**æ–¹æ³•**:
- `init()` - åˆå§‹åŒ–åº”ç”¨
- `toggleSidebar()` - åˆ‡æ¢ä¾§è¾¹æ 
- `toggleTheme()` - åˆ‡æ¢ä¸»é¢˜

#### Account Store (stores/account.js)

**çŠ¶æ€**:
```javascript
{
  accounts: Array,           // è´¦æˆ·åˆ—è¡¨
  currentAccountId: string,  // å½“å‰è´¦æˆ·ID
}
```

**æ–¹æ³•**:
- `loadAccounts()` - åŠ è½½è´¦æˆ·åˆ—è¡¨
- `addAccount(account)` - æ·»åŠ è´¦æˆ·
- `updateAccount(id, updates)` - æ›´æ–°è´¦æˆ·
- `deleteAccount(id)` - åˆ é™¤è´¦æˆ·
- `switchAccount(id)` - åˆ‡æ¢è´¦æˆ·

#### Mail Store (stores/mail.js)

**çŠ¶æ€**:
```javascript
{
  mails: Array,              // é‚®ä»¶åˆ—è¡¨
  currentFolder: string,     // å½“å‰æ–‡ä»¶å¤¹
  filter: Object,            // ç­›é€‰æ¡ä»¶
}
```

**æ–¹æ³•**:
- `loadMails(folder)` - åŠ è½½é‚®ä»¶
- `addMail(mail)` - æ·»åŠ é‚®ä»¶
- `deleteMail(id)` - åˆ é™¤é‚®ä»¶
- `markAsRead(id)` - æ ‡è®°å·²è¯»
- `toggleFlag(id)` - åˆ‡æ¢æ˜Ÿæ ‡

### 3. æœåŠ¡å±‚ (services/)

#### Storage Service

**åŠŸèƒ½**: æœ¬åœ°æ–‡ä»¶å­˜å‚¨
**æ”¯æŒç¯å¢ƒ**: Electronæ–‡ä»¶ç³»ç»Ÿ / æµè§ˆå™¨localStorage

```javascript
// è¯»å–JSON
await storageService.readJSON('accounts/accounts.json')

// å†™å…¥JSON
await storageService.writeJSON('accounts/accounts.json', data)
```

#### IMAP Service

**åŠŸèƒ½**: IMAPåè®®æ”¶å–é‚®ä»¶

```javascript
// è¿æ¥IMAP
await imapService.connect(config)

// è·å–é‚®ä»¶åˆ—è¡¨
const mails = await imapService.fetchMails(uids)

// æ ‡è®°å·²è¯»
await imapService.markAsRead(uid)
```

#### SMTP Service

**åŠŸèƒ½**: SMTPåè®®å‘é€é‚®ä»¶

```javascript
// å‘é€é‚®ä»¶
await smtpService.sendHtmlMail(config, {
  to: 'receiver@example.com',
  subject: 'Hello',
  html: '<p>Content</p>',
})
```

---

## å¼€å‘æŒ‡å—

### 1. æ·»åŠ æ–°é¡µé¢

#### æ­¥éª¤1: åˆ›å»ºVueç»„ä»¶

```vue
<!-- src/views/NewPage.vue -->
<template>
  <div class="new-page">
    <h1>æ–°é¡µé¢</h1>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const data = ref(null)
</script>

<style lang="scss" scoped>
.new-page {
  padding: 24px;
}
</style>
```

#### æ­¥éª¤2: æ·»åŠ è·¯ç”±

```javascript
// src/router/index.js
{
  path: '/new-page',
  name: 'NewPage',
  component: () => import('@/views/NewPage.vue'),
  meta: { title: 'æ–°é¡µé¢' },
}
```

#### æ­¥éª¤3: æ·»åŠ å¯¼èˆªé“¾æ¥

```vue
<router-link to="/new-page">æ–°é¡µé¢</router-link>
```

### 2. åˆ›å»ºæ–°çš„Store

```javascript
// src/stores/newStore.js
import { defineStore } from 'pinia'
import { ref } from 'vue'

export const useNewStore = defineStore('newStore', () => {
  const data = ref([])
  
  function loadData() {
    // åŠ è½½æ•°æ®é€»è¾‘
  }
  
  return {
    data,
    loadData,
  }
})
```

### 3. æ·»åŠ æ–°çš„Service

```javascript
// src/services/newService.js
class NewService {
  async fetchData() {
    // å®ç°é€»è¾‘
  }
}

export const newService = new NewService()
```

### 4. ä½¿ç”¨Ant Designç»„ä»¶

```vue
<template>
  <a-button type="primary" @click="handleClick">
    ç‚¹å‡»æˆ‘
  </a-button>
  
  <a-modal v-model:open="visible" title="æ ‡é¢˜">
    <p>å†…å®¹</p>
  </a-modal>
</template>

<script setup>
import { ref } from 'vue'

const visible = ref(false)

function handleClick() {
  visible.value = true
}
</script>
```

---

## æ‰©å±•åŠŸèƒ½

### 1. æ·»åŠ æ–°çš„é‚®ç®±æœåŠ¡å•†

#### æ­¥éª¤1: æ·»åŠ é…ç½®

```javascript
// src/views/Login.vue
const emailConfigs = {
  newmail: {
    imapHost: 'imap.newmail.com',
    imapPort: 993,
    smtpHost: 'smtp.newmail.com',
    smtpPort: 465,
    oauth2: false,
  },
}
```

#### æ­¥éª¤2: æ·»åŠ é€‰é¡¹

```vue
<a-select-option value="newmail">æ–°é‚®ç®±</a-select-option>
```

### 2. å®ç°OAuth2è®¤è¯

```javascript
// src/services/oauth.js
class OAuth2Service {
  async authenticateGmail() {
    // å®ç°Gmail OAuth2æµç¨‹
    // 1. è·å–æˆæƒURL
    // 2. æ‰“å¼€æµè§ˆå™¨çª—å£
    // 3. æ¥æ”¶å›è°ƒ
    // 4. äº¤æ¢token
  }
}
```

### 3. æ·»åŠ é‚®ä»¶æœç´¢åŠŸèƒ½

```javascript
// src/stores/mail.js
function searchMails(keyword) {
  return mails.value.filter(mail => 
    mail.subject.includes(keyword) ||
    mail.from.includes(keyword) ||
    mail.body.includes(keyword)
  )
}
```

### 4. å®ç°é‚®ä»¶è‰ç¨¿è‡ªåŠ¨ä¿å­˜

```vue
<script setup>
import { watch, debounce } from 'vue'

const draftContent = ref('')

// é˜²æŠ–è‡ªåŠ¨ä¿å­˜
const saveDraft = debounce(async () => {
  await mailStore.saveDraft(draftContent.value)
}, 1000)

watch(draftContent, saveDraft)
</script>
```

---

## è°ƒè¯•æŠ€å·§

### 1. Vue Devtools

å®‰è£…Vue Devtoolsæµè§ˆå™¨æ‰©å±•ï¼Œå¯ä»¥ï¼š
- æŸ¥çœ‹ç»„ä»¶æ ‘
- æ£€æŸ¥PiniaçŠ¶æ€
- è¿½è¸ªäº‹ä»¶

### 2. Electronè°ƒè¯•

```javascript
// electron/main.js
if (isDev) {
  mainWindow.webContents.openDevTools()
}
```

### 3. æ—¥å¿—è¾“å‡º

```javascript
// å¼€å‘ç¯å¢ƒæ—¥å¿—
if (import.meta.env.DEV) {
  console.log('Debug info:', data)
}
```

### 4. ç½‘ç»œè¯·æ±‚è°ƒè¯•

```javascript
// æ‹¦æˆªaxiosè¯·æ±‚
axios.interceptors.request.use(config => {
  console.log('Request:', config)
  return config
})
```

---

## å¸¸è§é—®é¢˜

### 1. IMAPè¿æ¥å¤±è´¥

**é—®é¢˜**: `Error: Connection timeout`

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- ç¡®è®¤é‚®ç®±å·²å¼€å¯IMAPæœåŠ¡
- éªŒè¯æœåŠ¡å™¨åœ°å€å’Œç«¯å£

### 2. é‚®ä»¶å‘é€å¤±è´¥

**é—®é¢˜**: `Error: Invalid login`

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨æˆæƒç è€Œéå¯†ç ï¼ˆQQã€163ã€126ï¼‰
- æ£€æŸ¥SMTPé…ç½®æ˜¯å¦æ­£ç¡®

### 3. æœ¬åœ°å­˜å‚¨å¤±è´¥

**é—®é¢˜**: `Cannot write file`

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥åº”ç”¨æ•°æ®ç›®å½•æƒé™
- ç¡®ä¿ç£ç›˜ç©ºé—´å……è¶³

### 4. Electronç™½å±

**é—®é¢˜**: å¯åŠ¨åæ˜¾ç¤ºç™½å±

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// ç¡®ä¿ç­‰å¾…ViteæœåŠ¡å™¨å¯åŠ¨
mainWindow.loadURL('http://localhost:5173')

// æˆ–æ£€æŸ¥ç”Ÿäº§ç¯å¢ƒè·¯å¾„
mainWindow.loadFile(path.join(__dirname, '../dist/index.html'))
```

---

## æœ€ä½³å®è·µ

### 1. ä»£ç è§„èŒƒ

- ä½¿ç”¨ESLintå’ŒPrettierä¿æŒä»£ç ä¸€è‡´æ€§
- éµå¾ªVue 3 Composition APIé£æ ¼
- ä½¿ç”¨`<script setup>`è¯­æ³•ç³–

### 2. ç»„ä»¶è®¾è®¡

- å•ä¸€èŒè´£åŸåˆ™
- Propså‘ä¸‹ï¼ŒEventså‘ä¸Š
- åˆç†ä½¿ç”¨ç»„åˆå¼å‡½æ•°(Composables)

### 3. çŠ¶æ€ç®¡ç†

- åŒºåˆ†æœ¬åœ°çŠ¶æ€å’Œå…¨å±€çŠ¶æ€
- é¿å…è¿‡åº¦ä½¿ç”¨Store
- ä½¿ç”¨computedæ´¾ç”ŸçŠ¶æ€

### 4. æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å¤„ç†å¤§åˆ—è¡¨
- æ‡’åŠ è½½è·¯ç”±ç»„ä»¶
- å›¾ç‰‡æ‡’åŠ è½½

---

## æµ‹è¯•

### å•å…ƒæµ‹è¯•

```javascript
// vitesté…ç½®
import { describe, it, expect } from 'vitest'

describe('MailStore', () => {
  it('should add mail correctly', () => {
    const store = useMailStore()
    store.addMail({ subject: 'Test' })
    expect(store.mails).toHaveLength(1)
  })
})
```

### E2Eæµ‹è¯•

ä½¿ç”¨Playwrightæˆ–Cypressè¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•

---

## å‘å¸ƒæµç¨‹

### 1. ç‰ˆæœ¬æ›´æ–°

```bash
# æ›´æ–°ç‰ˆæœ¬å·
npm version patch|minor|major
```

### 2. æ„å»ºåº”ç”¨

```bash
# æ„å»ºæ‰€æœ‰å¹³å°
npm run electron:build

# æˆ–å•ç‹¬æ„å»º
npm run electron:build:win
npm run electron:build:mac
npm run electron:build:linux
```

### 3. å‘å¸ƒåˆ°GitHub Releases

1. åˆ›å»ºGitæ ‡ç­¾
2. æ¨é€åˆ°ä»“åº“
3. ä¸Šä¼ æ„å»ºäº§ç‰©

---

## èµ„æºé“¾æ¥

- [Vue 3å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Ant Design Vue](https://antdv.com/)
- [Electronæ–‡æ¡£](https://www.electronjs.org/docs)
- [Piniaæ–‡æ¡£](https://pinia.vuejs.org/)
- [Viteæ–‡æ¡£](https://vitejs.dev/)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-10-19  
**ç»´æŠ¤è€…**: Maillionaire Development Team
